import{u as q}from"./ClcGhuih.js";import{K as N,M as I,_ as C,N as F,O as Y,P,a5 as G,z as $,r as J,a2 as O,o,c as l,a as A,H as f,V as p,al as b,U as g,F as w,d as k,t as E,J as z,an as U,l as M,I as Z,Y as D,ao as K}from"./iOswF-Mh.js";const R={wrapper:"",inner:"",label:{wrapper:"flex content-center items-center justify-between",base:"block font-medium text-gray-700 dark:text-gray-200",required:"after:content-['*'] after:ms-0.5 after:text-red-500 dark:after:text-red-400"},size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base"},container:"mt-1 relative",description:"text-gray-500 dark:text-gray-400",hint:"text-gray-500 dark:text-gray-400",help:"mt-2 text-gray-500 dark:text-gray-400",error:"mt-2 text-red-500 dark:text-red-400",default:{size:"sm"}},B=N(I.ui.strategy,I.ui.formGroup,R),H=F({inheritAttrs:!1,props:{name:{type:String,default:null},size:{type:String,default:null,validator(e){return Object.keys(B.size).includes(e)}},label:{type:String,default:null},description:{type:String,default:null},required:{type:Boolean,default:!1},help:{type:String,default:null},error:{type:[String,Boolean],default:null},hint:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},eagerValidation:{type:Boolean,default:!1}},setup(e){const{ui:s,attrs:a}=Y("formGroup",P(e,"ui"),B,P(e,"class")),n=G("form-errors",null),u=$(()=>{var v,c;return e.error&&typeof e.error=="string"||typeof e.error=="boolean"?e.error:(c=(v=n==null?void 0:n.value)==null?void 0:v.find(S=>S.path===e.name))==null?void 0:c.message}),t=$(()=>s.value.size[e.size??B.default.size]),m=J(q("$K7dDJpdOWE"));return O("form-group",{error:u,inputId:m,name:$(()=>e.name),size:$(()=>e.size),eagerValidation:$(()=>e.eagerValidation)}),{ui:s,attrs:a,inputId:m,size:t,error:u}}}),T=["for"];function W(e,s,a,n,u,t){return o(),l("div",g({class:e.ui.wrapper},e.attrs),[A("div",{class:f(e.ui.inner)},[e.label||e.$slots.label?(o(),l("div",{key:0,class:f([e.ui.label.wrapper,e.size])},[A("label",{for:e.inputId,class:f([e.ui.label.base,e.required?e.ui.label.required:""])},[e.$slots.label?p(e.$slots,"label",b(g({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(o(),l(w,{key:1},[k(E(e.label),1)],64))],10,T),e.hint||e.$slots.hint?(o(),l("span",{key:0,class:f([e.ui.hint])},[e.$slots.hint?p(e.$slots,"hint",b(g({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(o(),l(w,{key:1},[k(E(e.hint),1)],64))],2)):z("",!0)],2)):z("",!0),e.description||e.$slots.description?(o(),l("p",{key:1,class:f([e.ui.description,e.size])},[e.$slots.description?p(e.$slots,"description",b(g({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(o(),l(w,{key:1},[k(E(e.description),1)],64))],2)):z("",!0)],2),A("div",{class:f([e.label?e.ui.container:""])},[p(e.$slots,"default",b(U({error:e.error}))),typeof e.error=="string"&&e.error||e.$slots.error?(o(),l("p",{key:0,class:f([e.ui.error,e.size])},[e.$slots.error?p(e.$slots,"error",b(g({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(o(),l(w,{key:1},[k(E(e.error),1)],64))],2)):e.help||e.$slots.help?(o(),l("p",{key:1,class:f([e.ui.help,e.size])},[e.$slots.help?p(e.$slots,"help",b(g({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(o(),l(w,{key:1},[k(E(e.help),1)],64))],2)):z("",!0)],2)],16)}const ue=C(H,[["render",W]]);class j extends Error{constructor(s){super(s),this.message=s,Object.setPrototypeOf(this,j.prototype)}}const L=F({props:{schema:{type:Object,default:void 0},state:{type:Object,required:!0},validate:{type:Function,default:()=>[]},validateOn:{type:Array,default:()=>["blur","input","change","submit"]}},emits:["submit","error"],setup(e,{expose:s,emit:a}){const n=q("$Z55GngiEgp"),u=K(`form-${n}`);M(()=>{u.on(async r=>{var i;r.type!=="submit"&&((i=e.validateOn)!=null&&i.includes(r.type))&&await c(r.path,{silent:!0})})}),Z(()=>{u.reset()});const t=J([]);O("form-errors",t),O("form-events",u);const m=J({});O("form-inputs",m);async function v(){let r=await e.validate(e.state);if(e.schema)if(_(e.schema))r=r.concat(await ee(e.state,e.schema));else if(Q(e.schema))r=r.concat(await x(e.state,e.schema));else if(re(e.schema))r=r.concat(await ae(e.state,e.schema));else if(se(e.schema))r=r.concat(await ne(e.state,e.schema));else throw new Error("Form validation failed: Unsupported form schema");return r}async function c(r,i={silent:!1}){let d=r;if(r&&!Array.isArray(r)&&(d=[r]),d){const h=t.value.filter(y=>!d.includes(y.path)),V=(await v()).filter(y=>d.includes(y.path));t.value=h.concat(V)}else t.value=await v();if(t.value.length>0){if(i.silent)return!1;throw new j(`Form validation failed: ${JSON.stringify(t.value,null,2)}`)}return e.state}async function S(r){var d;const i=r;try{(d=e.validateOn)!=null&&d.includes("submit")&&await c();const h={...i,data:e.state};a("submit",h)}catch(h){if(!(h instanceof j))throw h;const V={...i,errors:t.value.map(y=>({...y,id:m.value[y.path]}))};a("error",V)}}return s({validate:c,errors:t,setErrors(r,i){t.value=r,i?t.value=t.value.filter(d=>d.path!==i).concat(r):t.value=r},async submit(){await S(new Event("submit"))},getErrors(r){return r?t.value.filter(i=>i.path===r):t.value},clear(r){r?t.value=t.value.filter(i=>i.path!==r):t.value=[]}}),{onSubmit:S}}});function Q(e){return e.validate&&e.__isYupSchema__}function X(e){return e.inner!==void 0}async function x(e,s){try{return await s.validate(e,{abortEarly:!1}),[]}catch(a){if(X(a))return a.inner.map(n=>({path:n.path??"",message:n.message}));throw a}}function _(e){return e.parse!==void 0}async function ee(e,s){const a=await s.safeParseAsync(e);return a.success===!1?a.error.issues.map(n=>({path:n.path.join("."),message:n.message})):[]}function re(e){return e.validateAsync!==void 0&&e.id!==void 0}function te(e){return e.isJoi===!0}async function ae(e,s){try{return await s.validateAsync(e,{abortEarly:!1}),[]}catch(a){if(te(a))return a.details.map(n=>({path:n.path.join("."),message:n.message}));throw a}}function se(e){return e._parse!==void 0}async function ne(e,s){const a=await s._parse(e);return a.issues?a.issues.map(n=>{var u;return{path:((u=n.path)==null?void 0:u.map(t=>t.key).join("."))||"",message:n.message}}):[]}function ie(e,s,a,n,u,t){return o(),l("form",{onSubmit:s[0]||(s[0]=D((...m)=>e.onSubmit&&e.onSubmit(...m),["prevent"]))},[p(e.$slots,"default")],32)}const de=C(L,[["render",ie]]);export{de as _,ue as a};
